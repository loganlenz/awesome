<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Contacts - Awesome Software</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            sans: ['Inter', 'system-ui', 'sans-serif'],
          },
        }
      }
    }
  </script>
  <style>
    .sidebar-link.active { background: rgb(250 232 255); color: rgb(162 28 175); }
    .sidebar-link:hover:not(.active) { background: rgb(243 244 246); }
    .modal-overlay { backdrop-filter: blur(4px); }
    .dropdown-menu { display: none; }
    .dropdown-menu.show { display: block; }
    .contact-row { cursor: pointer; }
    .contact-row:hover { background: rgb(249 250 251); }
    .pipeline-card { cursor: grab; }
    .pipeline-card:active { cursor: grabbing; }
    .slide-panel { transform: translateX(100%); transition: transform 0.3s ease; }
    .slide-panel.open { transform: translateX(0); }
  </style>
</head>
<body class="bg-gray-50 font-sans antialiased">
  <div class="flex h-screen overflow-hidden">
    <!-- Sidebar -->
    <aside class="w-64 bg-white border-r border-gray-200 flex flex-col">
      <div class="p-4 border-b border-gray-100">
        <a href="../index.html" class="flex items-center gap-2">
          <div class="w-8 h-8 bg-fuchsia-600 rounded-lg flex items-center justify-center">
            <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>
          </div>
          <span class="font-semibold text-gray-900">Awesome Software</span>
        </a>
      </div>
      <div class="p-4 border-b border-gray-100">
        <button class="w-full flex items-center justify-between px-3 py-2 bg-gray-50 rounded-lg hover:bg-gray-100 transition">
          <div class="flex items-center gap-2">
            <div class="w-6 h-6 bg-fuchsia-600 rounded flex items-center justify-center text-white text-xs font-medium">A</div>
            <span class="text-sm font-medium text-gray-900">Acme Corp</span>
          </div>
          <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 9l4-4 4 4m0 6l-4 4-4-4"/></svg>
        </button>
      </div>
      <nav class="flex-1 p-4 space-y-1 overflow-y-auto">
        <a href="dashboard.html" class="sidebar-link flex items-center gap-3 px-3 py-2 rounded-lg text-sm font-medium text-gray-600 transition">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"/></svg>
          Dashboard
        </a>
        <a href="contacts.html" class="sidebar-link active flex items-center gap-3 px-3 py-2 rounded-lg text-sm font-medium transition">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/></svg>
          Contacts
        </a>
        <a href="campaigns.html" class="sidebar-link flex items-center gap-3 px-3 py-2 rounded-lg text-sm font-medium text-gray-600 transition">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/></svg>
          Campaigns
        </a>
        <a href="messaging.html" class="sidebar-link flex items-center gap-3 px-3 py-2 rounded-lg text-sm font-medium text-gray-600 transition">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/></svg>
          Messaging
        </a>
        <a href="calendar.html" class="sidebar-link flex items-center gap-3 px-3 py-2 rounded-lg text-sm font-medium text-gray-600 transition">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/></svg>
          Calendar
        </a>
        <a href="websites.html" class="sidebar-link flex items-center gap-3 px-3 py-2 rounded-lg text-sm font-medium text-gray-600 transition">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"/></svg>
          Websites
        </a>
        <a href="automations.html" class="sidebar-link flex items-center gap-3 px-3 py-2 rounded-lg text-sm font-medium text-gray-600 transition">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>
          Automations
        </a>
        <a href="analytics.html" class="sidebar-link flex items-center gap-3 px-3 py-2 rounded-lg text-sm font-medium text-gray-600 transition">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/></svg>
          Analytics
        </a>
        <a href="reviews.html" class="sidebar-link flex items-center gap-3 px-3 py-2 rounded-lg text-sm font-medium text-gray-600 transition">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"/></svg>
          Reviews
        </a>
      </nav>
      <div class="p-4 border-t border-gray-100 space-y-1">
        <a href="settings.html" class="sidebar-link flex items-center gap-3 px-3 py-2 rounded-lg text-sm font-medium text-gray-600 transition">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/></svg>
          Settings
        </a>
        <a href="#" class="sidebar-link flex items-center gap-3 px-3 py-2 rounded-lg text-sm font-medium text-gray-600 transition">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
          Help & Support
        </a>
      </div>
      <div class="p-4 border-t border-gray-100">
        <div class="flex items-center gap-3">
          <div class="w-9 h-9 bg-fuchsia-100 rounded-full flex items-center justify-center text-fuchsia-600 font-medium text-sm">JD</div>
          <div class="flex-1 min-w-0">
            <div class="text-sm font-medium text-gray-900 truncate">John Doe</div>
            <div class="text-xs text-gray-500 truncate">john@acmecorp.com</div>
          </div>
          <a href="../login.html" class="p-1.5 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"/></svg>
          </a>
        </div>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 overflow-y-auto">
      <header class="bg-white border-b border-gray-200 px-6 py-4">
        <div class="flex items-center justify-between">
          <div>
            <h1 class="text-xl font-semibold text-gray-900">Contacts</h1>
            <p class="text-sm text-gray-500">Manage your contacts and sales pipeline</p>
          </div>
          <div class="flex items-center gap-3">
            <div class="relative">
              <svg class="w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/></svg>
              <input type="text" id="searchInput" oninput="searchContacts()" placeholder="Search contacts..." class="pl-10 pr-4 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-fuchsia-500 focus:border-fuchsia-500 outline-none w-64">
            </div>
            <div class="relative">
              <button onclick="toggleFilterDropdown()" class="flex items-center gap-2 px-4 py-2 border border-gray-200 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 transition">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"/></svg>
                Filter
                <span id="filterBadge" class="hidden px-1.5 py-0.5 text-xs bg-fuchsia-100 text-fuchsia-600 rounded-full">0</span>
              </button>
              <div id="filterDropdown" class="dropdown-menu absolute right-0 top-full mt-1 w-64 bg-white border border-gray-200 rounded-lg shadow-lg z-50">
                <div class="p-4 space-y-4">
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Stage</label>
                    <div class="space-y-2">
                      <label class="flex items-center gap-2 cursor-pointer">
                        <input type="checkbox" value="new" onchange="applyFilters()" class="filter-stage rounded border-gray-300 text-fuchsia-600 focus:ring-fuchsia-500">
                        <span class="text-sm text-gray-600">New Lead</span>
                      </label>
                      <label class="flex items-center gap-2 cursor-pointer">
                        <input type="checkbox" value="contacted" onchange="applyFilters()" class="filter-stage rounded border-gray-300 text-fuchsia-600 focus:ring-fuchsia-500">
                        <span class="text-sm text-gray-600">Contacted</span>
                      </label>
                      <label class="flex items-center gap-2 cursor-pointer">
                        <input type="checkbox" value="qualified" onchange="applyFilters()" class="filter-stage rounded border-gray-300 text-fuchsia-600 focus:ring-fuchsia-500">
                        <span class="text-sm text-gray-600">Qualified</span>
                      </label>
                      <label class="flex items-center gap-2 cursor-pointer">
                        <input type="checkbox" value="proposal" onchange="applyFilters()" class="filter-stage rounded border-gray-300 text-fuchsia-600 focus:ring-fuchsia-500">
                        <span class="text-sm text-gray-600">Proposal</span>
                      </label>
                      <label class="flex items-center gap-2 cursor-pointer">
                        <input type="checkbox" value="won" onchange="applyFilters()" class="filter-stage rounded border-gray-300 text-fuchsia-600 focus:ring-fuchsia-500">
                        <span class="text-sm text-gray-600">Won</span>
                      </label>
                    </div>
                  </div>
                  <div class="border-t border-gray-100 pt-4">
                    <button onclick="clearFilters()" class="w-full px-3 py-2 text-sm text-gray-600 hover:bg-gray-50 rounded-lg">Clear all filters</button>
                  </div>
                </div>
              </div>
            </div>
            <button onclick="openAddContactModal()" class="flex items-center gap-2 px-4 py-2 bg-fuchsia-600 text-white rounded-lg text-sm font-medium hover:bg-fuchsia-700 transition">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/></svg>
              Add Contact
            </button>
          </div>
        </div>
      </header>

      <div class="p-6">
        <!-- View Toggle & Bulk Actions -->
        <div class="flex items-center justify-between mb-6">
          <div class="flex items-center gap-4">
            <div class="flex bg-gray-100 rounded-lg p-1">
              <button onclick="setView('list')" id="listViewBtn" class="px-4 py-2 text-sm font-medium bg-white text-gray-900 rounded-md shadow-sm">List</button>
              <button onclick="setView('pipeline')" id="pipelineViewBtn" class="px-4 py-2 text-sm font-medium text-gray-600 hover:text-gray-900">Pipeline</button>
            </div>
            <div class="flex items-center gap-2 text-sm text-gray-500">
              <span id="contactCount">2,847 contacts</span>
              <span class="text-gray-300">|</span>
              <span>124 new this month</span>
            </div>
          </div>
          <div id="bulkActions" class="hidden flex items-center gap-2">
            <span class="text-sm text-gray-600"><span id="selectedCount">0</span> selected</span>
            <button onclick="bulkEmail()" class="px-3 py-1.5 text-sm text-gray-600 hover:text-gray-900 border border-gray-200 rounded-lg hover:bg-gray-50">
              <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/></svg>
              Email
            </button>
            <button onclick="bulkDelete()" class="px-3 py-1.5 text-sm text-red-600 hover:text-red-700 border border-red-200 rounded-lg hover:bg-red-50">
              <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/></svg>
              Delete
            </button>
          </div>
        </div>

        <!-- List View -->
        <div id="listView" class="bg-white rounded-xl border border-gray-200 overflow-hidden">
          <table class="w-full">
            <thead class="bg-gray-50 border-b border-gray-200">
              <tr>
                <th class="text-left px-6 py-3">
                  <input type="checkbox" id="selectAll" onchange="toggleSelectAll()" class="rounded border-gray-300 text-fuchsia-600 focus:ring-fuchsia-500">
                </th>
                <th class="text-left px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:text-gray-700" onclick="sortContacts('name')">
                  Contact
                  <svg class="w-3 h-3 inline ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"/></svg>
                </th>
                <th class="text-left px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider">Company</th>
                <th class="text-left px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider">Stage</th>
                <th class="text-left px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:text-gray-700" onclick="sortContacts('value')">
                  Value
                  <svg class="w-3 h-3 inline ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"/></svg>
                </th>
                <th class="text-left px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider">Last Activity</th>
                <th class="text-left px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider"></th>
              </tr>
            </thead>
            <tbody class="divide-y divide-gray-100" id="contactsTableBody">
              <!-- Contacts will be rendered here -->
            </tbody>
          </table>
          <div class="px-6 py-4 border-t border-gray-100 flex items-center justify-between">
            <div class="text-sm text-gray-500" id="paginationInfo">Showing 1-5 of 2,847 contacts</div>
            <div class="flex items-center gap-2">
              <button onclick="prevPage()" class="px-3 py-1.5 text-sm text-gray-500 hover:text-gray-700 border border-gray-200 rounded-lg hover:bg-gray-50">Previous</button>
              <button onclick="nextPage()" class="px-3 py-1.5 text-sm text-gray-500 hover:text-gray-700 border border-gray-200 rounded-lg hover:bg-gray-50">Next</button>
            </div>
          </div>
        </div>

        <!-- Pipeline View -->
        <div id="pipelineView" class="hidden grid grid-cols-5 gap-4">
          <div class="bg-gray-100 rounded-xl p-4">
            <div class="flex items-center justify-between mb-4">
              <h3 class="font-medium text-gray-900">New Lead</h3>
              <span class="text-xs bg-fuchsia-100 text-fuchsia-600 px-2 py-1 rounded-full" id="pipelineNewCount">0</span>
            </div>
            <div class="space-y-3" id="pipelineNew"></div>
          </div>
          <div class="bg-gray-100 rounded-xl p-4">
            <div class="flex items-center justify-between mb-4">
              <h3 class="font-medium text-gray-900">Contacted</h3>
              <span class="text-xs bg-blue-100 text-blue-600 px-2 py-1 rounded-full" id="pipelineContactedCount">0</span>
            </div>
            <div class="space-y-3" id="pipelineContacted"></div>
          </div>
          <div class="bg-gray-100 rounded-xl p-4">
            <div class="flex items-center justify-between mb-4">
              <h3 class="font-medium text-gray-900">Qualified</h3>
              <span class="text-xs bg-orange-100 text-orange-600 px-2 py-1 rounded-full" id="pipelineQualifiedCount">0</span>
            </div>
            <div class="space-y-3" id="pipelineQualified"></div>
          </div>
          <div class="bg-gray-100 rounded-xl p-4">
            <div class="flex items-center justify-between mb-4">
              <h3 class="font-medium text-gray-900">Proposal</h3>
              <span class="text-xs bg-purple-100 text-purple-600 px-2 py-1 rounded-full" id="pipelineProposalCount">0</span>
            </div>
            <div class="space-y-3" id="pipelineProposal"></div>
          </div>
          <div class="bg-gray-100 rounded-xl p-4">
            <div class="flex items-center justify-between mb-4">
              <h3 class="font-medium text-gray-900">Won</h3>
              <span class="text-xs bg-green-100 text-green-600 px-2 py-1 rounded-full" id="pipelineWonCount">0</span>
            </div>
            <div class="space-y-3" id="pipelineWon"></div>
          </div>
        </div>
      </div>
    </main>

    <!-- Contact Detail Panel -->
    <div id="detailPanel" class="slide-panel fixed top-0 right-0 h-full w-96 bg-white border-l border-gray-200 shadow-xl z-40 overflow-y-auto">
      <div class="p-6">
        <div class="flex items-center justify-between mb-6">
          <h2 class="text-lg font-semibold text-gray-900">Contact Details</h2>
          <button onclick="closeDetailPanel()" class="p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
          </button>
        </div>
        <div id="detailContent">
          <!-- Contact details will be rendered here -->
        </div>
      </div>
    </div>
  </div>

  <!-- Add/Edit Contact Modal -->
  <div id="contactModal" class="fixed inset-0 z-50 hidden">
    <div class="modal-overlay absolute inset-0 bg-black/50" onclick="closeContactModal()"></div>
    <div class="absolute inset-0 flex items-center justify-center p-4">
      <div class="bg-white rounded-2xl shadow-xl w-full max-w-md relative">
        <div class="flex items-center justify-between p-6 border-b border-gray-100">
          <h2 class="text-lg font-semibold text-gray-900" id="modalTitle">Add New Contact</h2>
          <button onclick="closeContactModal()" class="p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
          </button>
        </div>
        <form onsubmit="saveContact(event)" class="p-6 space-y-4">
          <input type="hidden" id="editContactId">
          <div class="grid grid-cols-2 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">First Name</label>
              <input type="text" id="contactFirstName" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-fuchsia-500 focus:border-fuchsia-500">
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Last Name</label>
              <input type="text" id="contactLastName" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-fuchsia-500 focus:border-fuchsia-500">
            </div>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
            <input type="email" id="contactEmail" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-fuchsia-500 focus:border-fuchsia-500">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Phone</label>
            <input type="tel" id="contactPhone" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-fuchsia-500 focus:border-fuchsia-500">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Company</label>
            <input type="text" id="contactCompany" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-fuchsia-500 focus:border-fuchsia-500">
          </div>
          <div class="grid grid-cols-2 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Stage</label>
              <select id="contactStage" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-fuchsia-500 focus:border-fuchsia-500">
                <option value="new">New Lead</option>
                <option value="contacted">Contacted</option>
                <option value="qualified">Qualified</option>
                <option value="proposal">Proposal</option>
                <option value="won">Won</option>
              </select>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Value ($)</label>
              <input type="number" id="contactValue" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-fuchsia-500 focus:border-fuchsia-500">
            </div>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Notes</label>
            <textarea id="contactNotes" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-fuchsia-500 focus:border-fuchsia-500"></textarea>
          </div>
          <div class="flex gap-3 pt-4">
            <button type="button" onclick="closeContactModal()" class="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 font-medium">Cancel</button>
            <button type="submit" class="flex-1 px-4 py-2 bg-fuchsia-600 text-white rounded-lg hover:bg-fuchsia-700 font-medium">Save Contact</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Delete Confirmation Modal -->
  <div id="deleteModal" class="fixed inset-0 z-50 hidden">
    <div class="modal-overlay absolute inset-0 bg-black/50" onclick="closeDeleteModal()"></div>
    <div class="absolute inset-0 flex items-center justify-center p-4">
      <div class="bg-white rounded-2xl shadow-xl w-full max-w-sm relative">
        <div class="p-6 text-center">
          <div class="w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4">
            <svg class="w-6 h-6 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/></svg>
          </div>
          <h3 class="text-lg font-semibold text-gray-900 mb-2">Delete Contact?</h3>
          <p class="text-sm text-gray-500 mb-6" id="deleteMessage">Are you sure you want to delete this contact? This action cannot be undone.</p>
          <div class="flex gap-3">
            <button onclick="closeDeleteModal()" class="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 font-medium">Cancel</button>
            <button onclick="confirmDelete()" class="flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 font-medium">Delete</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Toast Notification -->
  <div id="toast" class="fixed bottom-4 right-4 bg-gray-900 text-white px-4 py-3 rounded-lg shadow-lg transform translate-y-20 opacity-0 transition-all duration-300 z-50">
    <div class="flex items-center gap-3">
      <svg id="toastIcon" class="w-5 h-5 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
      <span id="toastMessage">Success!</span>
    </div>
  </div>

  <script>
    // Sample contacts data
    let contacts = [
      { id: 1, firstName: 'Sarah', lastName: 'Johnson', email: 'sarah@techcorp.com', phone: '+1 555-0101', company: 'Tech Corp', stage: 'won', value: 15000, lastActivity: '2 hours ago', color: 'blue' },
      { id: 2, firstName: 'Mike', lastName: 'Chen', email: 'mike@startup.io', phone: '+1 555-0102', company: 'Startup.io', stage: 'proposal', value: 8500, lastActivity: 'Yesterday', color: 'fuchsia' },
      { id: 3, firstName: 'Emily', lastName: 'Wilson', email: 'emily@design.co', phone: '+1 555-0103', company: 'Design Co', stage: 'qualified', value: 12000, lastActivity: '3 days ago', color: 'green' },
      { id: 4, firstName: 'James', lastName: 'Brown', email: 'james@enterprise.com', phone: '+1 555-0104', company: 'Enterprise Inc', stage: 'contacted', value: 25000, lastActivity: '1 week ago', color: 'orange' },
      { id: 5, firstName: 'Lisa', lastName: 'Martinez', email: 'lisa@agency.co', phone: '+1 555-0105', company: 'Marketing Agency', stage: 'new', value: 5000, lastActivity: 'Just now', color: 'purple' },
      { id: 6, firstName: 'David', lastName: 'Lee', email: 'david@corp.com', phone: '+1 555-0106', company: 'Big Corp', stage: 'new', value: 7500, lastActivity: '5 min ago', color: 'blue' },
      { id: 7, firstName: 'Anna', lastName: 'Smith', email: 'anna@media.io', phone: '+1 555-0107', company: 'Media Inc', stage: 'contacted', value: 9000, lastActivity: '2 days ago', color: 'green' },
      { id: 8, firstName: 'Tom', lastName: 'Davis', email: 'tom@tech.co', phone: '+1 555-0108', company: 'Tech Solutions', stage: 'qualified', value: 18000, lastActivity: '4 days ago', color: 'orange' }
    ];

    let currentView = 'list';
    let selectedContacts = new Set();
    let deleteTargetId = null;
    let currentPage = 1;
    const itemsPerPage = 5;

    // Initialize
    document.addEventListener('DOMContentLoaded', function() {
      renderContacts();
      renderPipeline();

      // Check URL params for filters
      const urlParams = new URLSearchParams(window.location.search);
      const stage = urlParams.get('stage');
      if (stage) {
        const checkbox = document.querySelector(`.filter-stage[value="${stage}"]`);
        if (checkbox) {
          checkbox.checked = true;
          applyFilters();
        }
      }
    });

    // View toggle
    function setView(view) {
      currentView = view;
      if (view === 'list') {
        document.getElementById('listView').classList.remove('hidden');
        document.getElementById('pipelineView').classList.add('hidden');
        document.getElementById('listViewBtn').classList.add('bg-white', 'text-gray-900', 'shadow-sm');
        document.getElementById('listViewBtn').classList.remove('text-gray-600');
        document.getElementById('pipelineViewBtn').classList.remove('bg-white', 'text-gray-900', 'shadow-sm');
        document.getElementById('pipelineViewBtn').classList.add('text-gray-600');
      } else {
        document.getElementById('listView').classList.add('hidden');
        document.getElementById('pipelineView').classList.remove('hidden');
        document.getElementById('pipelineViewBtn').classList.add('bg-white', 'text-gray-900', 'shadow-sm');
        document.getElementById('pipelineViewBtn').classList.remove('text-gray-600');
        document.getElementById('listViewBtn').classList.remove('bg-white', 'text-gray-900', 'shadow-sm');
        document.getElementById('listViewBtn').classList.add('text-gray-600');
        renderPipeline();
      }
    }

    // Render contacts table
    function renderContacts(filteredContacts = null) {
      const tbody = document.getElementById('contactsTableBody');
      const data = filteredContacts || contacts;
      const start = (currentPage - 1) * itemsPerPage;
      const end = start + itemsPerPage;
      const pageData = data.slice(start, end);

      const stageColors = {
        new: 'fuchsia',
        contacted: 'blue',
        qualified: 'orange',
        proposal: 'purple',
        won: 'green'
      };

      const stageLabels = {
        new: 'New Lead',
        contacted: 'Contacted',
        qualified: 'Qualified',
        proposal: 'Proposal',
        won: 'Won'
      };

      tbody.innerHTML = pageData.map(contact => `
        <tr class="contact-row hover:bg-gray-50" onclick="openDetailPanel(${contact.id})">
          <td class="px-6 py-4" onclick="event.stopPropagation()">
            <input type="checkbox" ${selectedContacts.has(contact.id) ? 'checked' : ''} onchange="toggleSelect(${contact.id})" class="rounded border-gray-300 text-fuchsia-600 focus:ring-fuchsia-500">
          </td>
          <td class="px-6 py-4">
            <div class="flex items-center gap-3">
              <div class="w-10 h-10 bg-${contact.color}-100 rounded-full flex items-center justify-center text-${contact.color}-600 font-medium">
                ${contact.firstName[0]}${contact.lastName[0]}
              </div>
              <div>
                <div class="font-medium text-gray-900">${contact.firstName} ${contact.lastName}</div>
                <div class="text-sm text-gray-500">${contact.email}</div>
              </div>
            </div>
          </td>
          <td class="px-6 py-4 text-sm text-gray-600">${contact.company}</td>
          <td class="px-6 py-4">
            <select onchange="changeStage(${contact.id}, this.value)" onclick="event.stopPropagation()" class="text-xs font-medium px-2.5 py-1 rounded-full border-0 bg-${stageColors[contact.stage]}-50 text-${stageColors[contact.stage]}-700 focus:ring-2 focus:ring-fuchsia-500">
              <option value="new" ${contact.stage === 'new' ? 'selected' : ''}>New Lead</option>
              <option value="contacted" ${contact.stage === 'contacted' ? 'selected' : ''}>Contacted</option>
              <option value="qualified" ${contact.stage === 'qualified' ? 'selected' : ''}>Qualified</option>
              <option value="proposal" ${contact.stage === 'proposal' ? 'selected' : ''}>Proposal</option>
              <option value="won" ${contact.stage === 'won' ? 'selected' : ''}>Won</option>
            </select>
          </td>
          <td class="px-6 py-4 text-sm font-medium text-gray-900">$${contact.value.toLocaleString()}</td>
          <td class="px-6 py-4 text-sm text-gray-500">${contact.lastActivity}</td>
          <td class="px-6 py-4" onclick="event.stopPropagation()">
            <div class="relative">
              <button onclick="toggleRowMenu(${contact.id})" class="p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"/></svg>
              </button>
              <div id="rowMenu${contact.id}" class="dropdown-menu absolute right-0 top-full mt-1 w-32 bg-white border border-gray-200 rounded-lg shadow-lg z-10">
                <button onclick="openEditModal(${contact.id})" class="w-full text-left px-3 py-2 text-sm text-gray-700 hover:bg-gray-50">Edit</button>
                <button onclick="sendEmail(${contact.id})" class="w-full text-left px-3 py-2 text-sm text-gray-700 hover:bg-gray-50">Send Email</button>
                <button onclick="openDeleteModal(${contact.id})" class="w-full text-left px-3 py-2 text-sm text-red-600 hover:bg-red-50">Delete</button>
              </div>
            </div>
          </td>
        </tr>
      `).join('');

      document.getElementById('paginationInfo').textContent = `Showing ${start + 1}-${Math.min(end, data.length)} of ${data.length} contacts`;
      document.getElementById('contactCount').textContent = `${data.length} contacts`;
    }

    // Render pipeline view
    function renderPipeline() {
      const stages = ['new', 'contacted', 'qualified', 'proposal', 'won'];
      stages.forEach(stage => {
        const stageContacts = contacts.filter(c => c.stage === stage);
        const container = document.getElementById(`pipeline${stage.charAt(0).toUpperCase() + stage.slice(1)}`);
        const countEl = document.getElementById(`pipeline${stage.charAt(0).toUpperCase() + stage.slice(1)}Count`);

        countEl.textContent = stageContacts.length;
        container.innerHTML = stageContacts.map(contact => `
          <div class="pipeline-card bg-white rounded-lg p-3 shadow-sm border border-gray-200 hover:shadow-md transition" onclick="openDetailPanel(${contact.id})">
            <div class="flex items-center gap-2 mb-2">
              <div class="w-8 h-8 bg-${contact.color}-100 rounded-full flex items-center justify-center text-${contact.color}-600 font-medium text-xs">
                ${contact.firstName[0]}${contact.lastName[0]}
              </div>
              <div class="flex-1 min-w-0">
                <div class="font-medium text-gray-900 text-sm truncate">${contact.firstName} ${contact.lastName}</div>
                <div class="text-xs text-gray-500 truncate">${contact.company}</div>
              </div>
            </div>
            <div class="flex items-center justify-between text-xs">
              <span class="text-gray-500">${contact.lastActivity}</span>
              <span class="font-medium text-gray-900">$${contact.value.toLocaleString()}</span>
            </div>
          </div>
        `).join('');
      });
    }

    // Search contacts
    function searchContacts() {
      const query = document.getElementById('searchInput').value.toLowerCase();
      const filtered = contacts.filter(c =>
        c.firstName.toLowerCase().includes(query) ||
        c.lastName.toLowerCase().includes(query) ||
        c.email.toLowerCase().includes(query) ||
        c.company.toLowerCase().includes(query)
      );
      currentPage = 1;
      renderContacts(filtered);
    }

    // Filter dropdown
    function toggleFilterDropdown() {
      document.getElementById('filterDropdown').classList.toggle('show');
    }

    function applyFilters() {
      const selectedStages = Array.from(document.querySelectorAll('.filter-stage:checked')).map(cb => cb.value);
      const badge = document.getElementById('filterBadge');

      if (selectedStages.length > 0) {
        badge.classList.remove('hidden');
        badge.textContent = selectedStages.length;
        const filtered = contacts.filter(c => selectedStages.includes(c.stage));
        renderContacts(filtered);
      } else {
        badge.classList.add('hidden');
        renderContacts();
      }
    }

    function clearFilters() {
      document.querySelectorAll('.filter-stage').forEach(cb => cb.checked = false);
      document.getElementById('filterBadge').classList.add('hidden');
      document.getElementById('filterDropdown').classList.remove('show');
      renderContacts();
    }

    // Selection
    function toggleSelect(id) {
      if (selectedContacts.has(id)) {
        selectedContacts.delete(id);
      } else {
        selectedContacts.add(id);
      }
      updateBulkActions();
    }

    function toggleSelectAll() {
      const selectAll = document.getElementById('selectAll').checked;
      if (selectAll) {
        contacts.forEach(c => selectedContacts.add(c.id));
      } else {
        selectedContacts.clear();
      }
      renderContacts();
      updateBulkActions();
    }

    function updateBulkActions() {
      const bulkActions = document.getElementById('bulkActions');
      const selectedCount = document.getElementById('selectedCount');
      if (selectedContacts.size > 0) {
        bulkActions.classList.remove('hidden');
        bulkActions.classList.add('flex');
        selectedCount.textContent = selectedContacts.size;
      } else {
        bulkActions.classList.add('hidden');
        bulkActions.classList.remove('flex');
      }
    }

    // Row menu
    function toggleRowMenu(id) {
      document.querySelectorAll('[id^="rowMenu"]').forEach(m => {
        if (m.id !== `rowMenu${id}`) m.classList.remove('show');
      });
      document.getElementById(`rowMenu${id}`).classList.toggle('show');
    }

    // Stage change
    function changeStage(id, newStage) {
      const contact = contacts.find(c => c.id === id);
      if (contact) {
        contact.stage = newStage;
        renderContacts();
        renderPipeline();
        showToast(`${contact.firstName} moved to ${newStage}`);
      }
    }

    // Detail panel
    function openDetailPanel(id) {
      const contact = contacts.find(c => c.id === id);
      if (!contact) return;

      const stageLabels = { new: 'New Lead', contacted: 'Contacted', qualified: 'Qualified', proposal: 'Proposal', won: 'Won' };

      document.getElementById('detailContent').innerHTML = `
        <div class="text-center mb-6">
          <div class="w-20 h-20 bg-${contact.color}-100 rounded-full flex items-center justify-center text-${contact.color}-600 font-semibold text-2xl mx-auto mb-3">
            ${contact.firstName[0]}${contact.lastName[0]}
          </div>
          <h3 class="text-xl font-semibold text-gray-900">${contact.firstName} ${contact.lastName}</h3>
          <p class="text-gray-500">${contact.company}</p>
        </div>
        <div class="space-y-4">
          <div>
            <label class="text-xs font-medium text-gray-500 uppercase">Email</label>
            <div class="text-gray-900">${contact.email}</div>
          </div>
          <div>
            <label class="text-xs font-medium text-gray-500 uppercase">Phone</label>
            <div class="text-gray-900">${contact.phone}</div>
          </div>
          <div>
            <label class="text-xs font-medium text-gray-500 uppercase">Stage</label>
            <div class="text-gray-900">${stageLabels[contact.stage]}</div>
          </div>
          <div>
            <label class="text-xs font-medium text-gray-500 uppercase">Deal Value</label>
            <div class="text-gray-900 font-semibold">$${contact.value.toLocaleString()}</div>
          </div>
          <div>
            <label class="text-xs font-medium text-gray-500 uppercase">Last Activity</label>
            <div class="text-gray-900">${contact.lastActivity}</div>
          </div>
        </div>
        <div class="flex gap-3 mt-6">
          <button onclick="openEditModal(${contact.id}); closeDetailPanel();" class="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 font-medium">Edit</button>
          <button onclick="sendEmail(${contact.id})" class="flex-1 px-4 py-2 bg-fuchsia-600 text-white rounded-lg hover:bg-fuchsia-700 font-medium">Email</button>
        </div>
        <button onclick="window.location.href='messaging.html'" class="w-full mt-3 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 font-medium">Send Message</button>
      `;
      document.getElementById('detailPanel').classList.add('open');
    }

    function closeDetailPanel() {
      document.getElementById('detailPanel').classList.remove('open');
    }

    // Modals
    function openAddContactModal() {
      document.getElementById('modalTitle').textContent = 'Add New Contact';
      document.getElementById('editContactId').value = '';
      document.getElementById('contactFirstName').value = '';
      document.getElementById('contactLastName').value = '';
      document.getElementById('contactEmail').value = '';
      document.getElementById('contactPhone').value = '';
      document.getElementById('contactCompany').value = '';
      document.getElementById('contactStage').value = 'new';
      document.getElementById('contactValue').value = '';
      document.getElementById('contactNotes').value = '';
      document.getElementById('contactModal').classList.remove('hidden');
    }

    function openEditModal(id) {
      const contact = contacts.find(c => c.id === id);
      if (!contact) return;

      document.getElementById('modalTitle').textContent = 'Edit Contact';
      document.getElementById('editContactId').value = id;
      document.getElementById('contactFirstName').value = contact.firstName;
      document.getElementById('contactLastName').value = contact.lastName;
      document.getElementById('contactEmail').value = contact.email;
      document.getElementById('contactPhone').value = contact.phone;
      document.getElementById('contactCompany').value = contact.company;
      document.getElementById('contactStage').value = contact.stage;
      document.getElementById('contactValue').value = contact.value;
      document.getElementById('contactNotes').value = contact.notes || '';
      document.getElementById('contactModal').classList.remove('hidden');

      document.querySelectorAll('[id^="rowMenu"]').forEach(m => m.classList.remove('show'));
    }

    function closeContactModal() {
      document.getElementById('contactModal').classList.add('hidden');
    }

    function saveContact(e) {
      e.preventDefault();
      const id = document.getElementById('editContactId').value;
      const firstName = document.getElementById('contactFirstName').value;
      const lastName = document.getElementById('contactLastName').value;
      const email = document.getElementById('contactEmail').value;
      const phone = document.getElementById('contactPhone').value;
      const company = document.getElementById('contactCompany').value;
      const stage = document.getElementById('contactStage').value;
      const value = parseInt(document.getElementById('contactValue').value) || 0;
      const notes = document.getElementById('contactNotes').value;

      const colors = ['blue', 'fuchsia', 'green', 'orange', 'purple'];

      if (id) {
        // Edit existing
        const contact = contacts.find(c => c.id === parseInt(id));
        if (contact) {
          Object.assign(contact, { firstName, lastName, email, phone, company, stage, value, notes });
          showToast('Contact updated successfully');
        }
      } else {
        // Add new
        const newContact = {
          id: Date.now(),
          firstName,
          lastName,
          email,
          phone,
          company,
          stage,
          value,
          notes,
          lastActivity: 'Just now',
          color: colors[Math.floor(Math.random() * colors.length)]
        };
        contacts.unshift(newContact);
        showToast('Contact added successfully');
      }

      closeContactModal();
      renderContacts();
      renderPipeline();
    }

    function openDeleteModal(id) {
      deleteTargetId = id;
      const contact = contacts.find(c => c.id === id);
      document.getElementById('deleteMessage').textContent = `Are you sure you want to delete ${contact.firstName} ${contact.lastName}? This action cannot be undone.`;
      document.getElementById('deleteModal').classList.remove('hidden');
      document.querySelectorAll('[id^="rowMenu"]').forEach(m => m.classList.remove('show'));
    }

    function closeDeleteModal() {
      document.getElementById('deleteModal').classList.add('hidden');
      deleteTargetId = null;
    }

    function confirmDelete() {
      if (deleteTargetId) {
        contacts = contacts.filter(c => c.id !== deleteTargetId);
        showToast('Contact deleted');
        closeDeleteModal();
        closeDetailPanel();
        renderContacts();
        renderPipeline();
      }
    }

    // Bulk actions
    function bulkEmail() {
      showToast(`Sending email to ${selectedContacts.size} contacts...`);
      selectedContacts.clear();
      updateBulkActions();
      renderContacts();
    }

    function bulkDelete() {
      if (confirm(`Delete ${selectedContacts.size} contacts?`)) {
        contacts = contacts.filter(c => !selectedContacts.has(c.id));
        selectedContacts.clear();
        updateBulkActions();
        renderContacts();
        renderPipeline();
        showToast('Contacts deleted');
      }
    }

    // Email action
    function sendEmail(id) {
      const contact = contacts.find(c => c.id === id);
      if (contact) {
        window.location.href = `mailto:${contact.email}`;
      }
    }

    // Pagination
    function prevPage() {
      if (currentPage > 1) {
        currentPage--;
        renderContacts();
      }
    }

    function nextPage() {
      if (currentPage * itemsPerPage < contacts.length) {
        currentPage++;
        renderContacts();
      }
    }

    // Sort
    function sortContacts(field) {
      if (field === 'name') {
        contacts.sort((a, b) => a.firstName.localeCompare(b.firstName));
      } else if (field === 'value') {
        contacts.sort((a, b) => b.value - a.value);
      }
      renderContacts();
    }

    // Toast
    function showToast(message) {
      const toast = document.getElementById('toast');
      document.getElementById('toastMessage').textContent = message;
      toast.classList.remove('translate-y-20', 'opacity-0');
      setTimeout(() => toast.classList.add('translate-y-20', 'opacity-0'), 3000);
    }

    // Close dropdowns on outside click
    document.addEventListener('click', function(e) {
      if (!e.target.closest('.relative')) {
        document.querySelectorAll('.dropdown-menu').forEach(d => d.classList.remove('show'));
      }
    });

    // Keyboard shortcuts
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') {
        closeContactModal();
        closeDeleteModal();
        closeDetailPanel();
      }
      if ((e.ctrlKey || e.metaKey) && e.key === 'n') {
        e.preventDefault();
        openAddContactModal();
      }
    });
  </script>
</body>
</html>
